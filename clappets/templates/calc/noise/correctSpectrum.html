<!DOCTYPE html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Clappets.com</title>
    <link rel="stylesheet" type="text/css" href="/static/css/bulma.css">
    <link rel="stylesheet" type="text/css" href="/static/font-awesome/css/font-awesome.css">
    <link rel="stylesheet" type="text/css" href="/static/css/calculator.css">

    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/javascript" src="/static/js/clappetsunits.js"></script>

</head>

<body>
    <section class="section">
        <div class="container">
            <div class="columns is-centered" style="border-bottom:0px;">
                <div class="column is-6">
                    <nav class="breadcrumb is-right" aria-label="breadcrumbs">
                        <ul>
                            <li><a href="#"><span class="icon is-small">Home</a></li>
                            <li><a href="#"><span>Calculations</span></a></li>
                            <li><a href="#"><span>Noise</span></a></li>
                        </ul>
                    </nav>


                    <h1 class="title" style="text-align:center;">A-weighted Overall Noise Level Calculation</h1>

                    <div id="app">
                        <div class="tabs is-boxed">
                            <ul>
                                <li v-bind:class="{'is-active': calcPageActive}">
                                    <a name="calc_menu" @click="activatePage">Calc</a>
                                </li>
                                <li v-bind:class="{'is-active': infoPageActive }">
                                    <a name="info_menu" @click="activatePage">Info</a>
                                </li>
                                <li v-bind:class="{'is-active': unitsPageActive }">
                                    <a name="units_menu" @click="activatePage">Units</a>
                                </li>
                                <li v-bind:class="{'is-active': helpPageActive }">
                                    <a name="help_menu" @click="activatePage">Help</a>
                                </li>
                            </ul>
                        </div>
                        <div class="box" v-show="calcPageActive">

                            <div class="columns is-mobile">
                                <div class="column" style="padding:2px;">
                                    Freq
                                </div>
                                <div class="column" style="padding:2px;">
                                    Total
                                </div>
                                <div class="column" style="padding:2px;">
                                    B/Ground
                                </div>
                                <div class="column" style="padding:2px;">
                                    Corrected
                                </div>
                            </div>
                            <div class="columns is-mobile">
                                <div class="column" style="padding:2px;">
                                    (Hz)
                                </div>
                                <div class="column" style="padding:2px;">
                                    (dB)
                                </div>
                                <div class="column" style="padding:2px;">
                                    (dB)
                                </div>
                                <div class="column" style="padding:2px;">
                                    (dBA)
                                </div>
                            </div>
                            <div class="columns is-mobile">
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" value="63" readonly>
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" v-model="totalSpectrum['f63']">
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" v-model="backgroundSpectrum['f63']">
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" readonly v-model="correctedSpectrum['f63']">
                                </div>
                            </div>
                            <div class="columns is-mobile">
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" value="125" readonly>
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" v-model="totalSpectrum['f125']">
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" v-model="backgroundSpectrum['f125']">
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" readonly v-model="correctedSpectrum['f125']">
                                </div>
                            </div>
                            <div class="columns is-mobile">
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" value="250" readonly>
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" v-model="totalSpectrum['f250']">
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" v-model="backgroundSpectrum['f250']">
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" readonly v-model="correctedSpectrum['f250']">
                                </div>
                            </div>
                            <div class="columns is-mobile">
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" value="500" readonly>
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" v-model="totalSpectrum['f500']">
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" v-model="backgroundSpectrum['f500']">
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" readonly v-model="correctedSpectrum['f500']">
                                </div>
                            </div>
                            <div class="columns is-mobile">
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" value="1000" readonly>
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" v-model="totalSpectrum['f1000']">
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" v-model="backgroundSpectrum['f1000']">
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" readonly v-model="correctedSpectrum['f1000']">
                                </div>
                            </div>
                            <div class="columns is-mobile">
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" value="2000" readonly>
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" v-model="totalSpectrum['f2000']">
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" v-model="backgroundSpectrum['f2000']">
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" readonly v-model="correctedSpectrum['f2000']">
                                </div>
                            </div>
                            <div class="columns is-mobile">
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" value="4000" readonly>
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" v-model="totalSpectrum['f4000']">
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" v-model="backgroundSpectrum['f4000']">
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" readonly v-model="correctedSpectrum['f4000']">
                                </div>
                            </div>
                            <div class="columns is-mobile">
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" value="8000" readonly>
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" v-model="totalSpectrum['f8000']">
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" v-model="backgroundSpectrum['f8000']">
                                </div>
                                <div class="column" style="padding:2px;">
                                    <input class="input is-small" type="number" name="" readonly v-model="correctedSpectrum['f8000']">
                                </div>
                            </div>

                            <article class="message is-small is-danger" v-show="errorBoxActive">
                                <div class="message-header">
                                    <p>Errors</p>
                                    <button class="delete is-small" aria-label="delete" @click="hideErrorBox"></button>
                                </div>
                                <div class="message-body">
                                    [[ error]]
                                    <p>Total Spectrum:</p>
                                    <p class="help is-danger" v-for="(key, error) in totalSpectrum_errors">[[key]]-[[ error ]]</p>
                                    <p>Background Spectrum</p>
                                    <p class="help is-danger" v-for="(key, error) in backgroundSpectrum_errors">[[key]]-[[ error ]]</p>
                                </div>
                            </article>
                            <a class="button is-primary" style="width:100%" v-on:click="calculate_result">Calculate</a>
                        </div>

                        <div class="box" v-show="infoPageActive">

                            <div class="columns">
                                <div class="column is-4">Project</label>
                                </div>
                                <div class="column is-8">
                                    <input class="input" type="text" name="" value="">
                                </div>
                            </div>
                            <div class="columns ">
                                <div class="column is-4">Client</label>
                                </div>
                                <div class="column is-8">
                                    <input class="input" type="text" name="" value="">
                                </div>
                            </div>
                            <div class="columns ">
                                <div class="column is-4">Location</label>
                                </div>
                                <div class="column is-8">
                                    <input class="input" type="text" name="" value="">
                                </div>
                            </div>
                            <div class="columns ">
                                <div class="column is-4">Item No.</label>
                                </div>
                                <div class="column is-8">
                                    <input class="input" type="text" name="" value="">
                                </div>
                            </div>

                            <div class="columns ">
                                <div class="column is-4">Purpose</label>
                                </div>
                                <div class="column is-8">
                                    <textarea class="textarea" rows="5" type="text" name="" value=""></textarea>
                                </div>
                            </div>

                            <div class="columns ">
                                <div class="column is-4">Conclusion</label>
                                </div>
                                <div class="column is-8">
                                    <textarea class="textarea" rows="5" type="text" name="" value=""></textarea>

                                </div>
                            </div>

                        </div>


                        <div class="box" v-show="unitsPageActive">
                            <div class="columns is-centered">
                                <div class="column">
                                    <div class="control">
                                        <label class="radio"><input type="radio" name="useDefaultUnit" v-model="useDefaultUnits" value="true">Default Units</label>
                                        <label class="radio"><input type="radio" name="useDefaultUnit" v-model="useDefaultUnits" value="false">Custom Units</label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="box" v-show="helpPageActive">
                            There is help here.
                        </div>





                        </div>
                    </div>
                </div>
            </div>
        </section>







        <script src="/static/js/vue.js"></script>
        <script src="https://unpkg.com/axios@0.16.2/dist/axios.min.js"></script>
        <script src="https://unpkg.com/lodash@4.17.2/lodash.min.js"></script>


        <script>
            var app = new Vue({
                el: '#app',
                delimiters : ['[[',']]'],
                data: {
                    calcPageActive: true,
                    infoPageActive: false,
                    unitsPageActive: false,
                    helpPageActive: false,

                    errorBoxActive:false,
                    error :'',

                    totalSpectrum:{
                            "f63":"",
                            "f125":"",
                            "f250":"",
                            "f500":"",
                            "f1000":"",
                            "f2000":"",
                            "f4000":"",
                            "f8000":"",
                        },
                    totalSpectrum_errors:[],

                    backgroundSpectrum : {
                        "f63":"",
                        "f125":"",
                        "f250":"",
                        "f500":"",
                        "f1000":"",
                        "f2000":"",
                        "f4000":"",
                        "f8000":"",
                    },
                    backgroundSpectrum_errors:[],

                    correctedSpectrum : {
                        "f63":"",
                        "125":"",
                        "250":"",
                        "f500":"",
                        "f1000":"",
                        "f2000":"",
                        "f4000":"",
                        "f8000":"",
                    },

                    useDefaultUnits: 'true',
                    unitLengthCustom : '0',
                },

                computed: {
                    unitLength : function(){
                        if (this.useDefaultUnits=='true'){
                            return 0;
                        }
                        else {
                            return this.unitLengthCustom;
                        }
                    },

                    unitLengthLabel: function(){
                        return getUnitLabel('length', this.unitLength)
                    },


                },


                methods: {
                    activatePage: function(event) {
                        page_menu = event.target.name;
                        this.calcPageActive = false;
                        this.infoPageActive = false;
                        this.unitsPageActive = false;
                        this.helpPageActive = false;
                        if (page_menu == 'calc_menu') {
                            this.calcPageActive = true;
                        }
                        if (page_menu == 'info_menu') {
                            this.infoPageActive = true;
                        }
                        if (page_menu == 'units_menu') {
                            this.unitsPageActive = true;
                        }
                        if (page_menu == 'help_menu') {
                            this.helpPageActive = true;
                        }
                    },

                    calculate_result : function(){
                      var app = this;
                      url = '/calcapi/noise/correctSpectrum/';
                      axios.post(url, {
                        totalSpectrum : app.totalSpectrum,
                        backgroundSpectrum : app.backgroundSpectrum,
    		              })
                        .then(function (response) {
                            app.correctedSpectrum = response.data.correctedSpectrum,
                            console.log(response);
                            app.resetErrors();
                        })
                        .catch(function (error) {
                            console.log(error);
                            app.scanErrors(error);
                        });
                    },

                    hideErrorBox: function(){
                        this.errorBoxActive=false;
                    },

                    scanErrors: function(error){
                        this.errorBoxActive = true;
                        this.error = error.response.status + " : " + error.response.statusText;
                        this.totalSpectrum_errors = error.response.data["totalSpectrum"];
                        this.backgroundSpectrum_errors = error.response.data["backgroundSpectrum"];
                    },

                    resetErrors: function(){
                      this.errorBoxActive = false;
                      this.error = '';
                      this.totalSpectrum_errors = [];
                      this.backgroundSpectrum_errors = [];
                    },





                }
            })
        </script>
    </body>

    </html>
